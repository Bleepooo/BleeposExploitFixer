package dev.bleepo.bleeposexploitfixer.patches;

import dev.bleepo.bleeposexploitfixer.Main;
import org.bukkit.Chunk;
import org.bukkit.entity.Entity;
import org.bukkit.entity.EntityType;
import org.bukkit.event.EventHandler;
import org.bukkit.event.Listener;
import org.bukkit.event.world.ChunkLoadEvent;
import org.bukkit.event.world.ChunkUnloadEvent;

public class PurgeWitherSkulls implements Listener {
    private final Main plugin;

    public PurgeWitherSkulls(Main plugin) {
        this.plugin = plugin;
    }

    @EventHandler
    public void chunkLoad(ChunkLoadEvent e) {
        if(plugin.getConfig().getBoolean("purgewitherskulls")) {
            noSkulls(e.getChunk());
        }
    }

    @EventHandler
    public void chunkUnload(ChunkUnloadEvent e) {
        if(plugin.getConfig().getBoolean("purgewitherskulls")) {
            noSkulls(e.getChunk());
        }
    }

    void noSkulls(Chunk chunk) {
        for(Entity entity : chunk.getEntities()) {
            if(entity.getType() == EntityType.WITHER_SKULL) entity.remove();
        }
    }
}
